{"version":3,"sources":["withDisableFrameProcessorsIOS.ts"],"names":["withDisableFrameProcessorsIOS","c","config","xcodeProject","modResults","configurations","pbxXCBuildConfigurationSection","inheritKey","valueKey","key","buildSettings","preprocessorDefinitions","GCC_PREPROCESSOR_DEFINITIONS","includes","push"],"mappings":";;;;;;;AACA;;AADA;;AAGA;AACA;AACA;AACA;AACO,MAAMA,6BAA2C,GAAIC,CAAD,IAAO;AAChE,SAAO,qCAAiBA,CAAjB,EAAqBC,MAAD,IAAY;AACrC,UAAMC,YAA0B,GAAGD,MAAM,CAACE,UAA1C;AAEA,UAAMC,cAAc,GAAGF,YAAY,CAACG,8BAAb,EAAvB;AAEA,UAAMC,UAAU,GAAG,gBAAnB;AACA,UAAMC,QAAQ,GAAG,4CAAjB;;AAEA,SAAK,MAAMC,GAAX,IAAkBJ,cAAlB,EAAkC;AAAA;;AAChC,YAAMK,aAAa,GAAGL,cAAc,CAACI,GAAD,CAAd,CAAoBC,aAA1C;AACA,UAAIA,aAAa,IAAI,IAArB,EAA2B;AAE3B,YAAMC,uBAAuB,4BAAID,aAAa,CAACE,4BAAlB,yEAAkD,CAACL,UAAD,CAA/E;AAEA,UAAI,CAACI,uBAAuB,CAACE,QAAxB,CAAiCL,QAAjC,CAAL,EAAiDG,uBAAuB,CAACG,IAAxB,CAA6BN,QAA7B;AACjDE,MAAAA,aAAa,CAACE,4BAAd,GAA6CD,uBAA7C;AACD;;AACD,WAAOT,MAAP;AACD,GAlBM,CAAP;AAmBD,CApBM","sourcesContent":["/* eslint-disable @typescript-eslint/no-unsafe-assignment */\nimport { ConfigPlugin, withXcodeProject, XcodeProject } from '@expo/config-plugins';\n\n/**\n * Set the `disableFrameProcessors` inside of the XcodeProject.\n * This is used to disable frame processors if you don't need it on iOS. (will save CPU and Memory)\n */\nexport const withDisableFrameProcessorsIOS: ConfigPlugin = (c) => {\n  return withXcodeProject(c, (config) => {\n    const xcodeProject: XcodeProject = config.modResults;\n\n    const configurations = xcodeProject.pbxXCBuildConfigurationSection();\n\n    const inheritKey = '\"$(inherited)\"';\n    const valueKey = '\"VISION_CAMERA_DISABLE_FRAME_PROCESSORS=1\"';\n\n    for (const key in configurations) {\n      const buildSettings = configurations[key].buildSettings;\n      if (buildSettings == null) continue;\n\n      const preprocessorDefinitions = (buildSettings.GCC_PREPROCESSOR_DEFINITIONS ?? [inheritKey]) as string[];\n\n      if (!preprocessorDefinitions.includes(valueKey)) preprocessorDefinitions.push(valueKey);\n      buildSettings.GCC_PREPROCESSOR_DEFINITIONS = preprocessorDefinitions;\n    }\n    return config;\n  });\n};\n"]}